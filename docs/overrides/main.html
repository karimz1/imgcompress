{% extends "base.html" %}

{% block extrahead %}
<!-- Performance: DNS Prefetch & Preconnect for critical third-party origins -->
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
<link rel="dns-prefetch" href="https://unpkg.com">
<link rel="dns-prefetch" href="https://dfyf412h8jisw.cloudfront.net">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://dfyf412h8jisw.cloudfront.net">

<!-- Preload critical resources -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style">
<link rel="preload" as="fetch" href="https://dfyf412h8jisw.cloudfront.net/pulls/karimz1/imgcompress" crossorigin>

<!-- Font Awesome with async loading -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" media="print"
  onload="this.media='all'">
<noscript>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</noscript>

<!-- Tippy.js tooltip library - defer loading -->
<script src="https://unpkg.com/@popperjs/core@2" defer></script>
<script src="https://unpkg.com/tippy.js@6" defer></script>
<link rel="stylesheet" href="https://unpkg.com/tippy.js@6/animations/shift-away.css" media="print"
  onload="this.media='all'">

<!-- Critical Path CSS: Pre-render layout to eliminate FCP/LCP bottlenecks -->
<style>
  /* Minimal logic to ensure text visibility during font load */
  body {
    font-display: swap !important;
  }

  /* Reserve space for Docker pull count to prevent layout shift */
  .docker-pull-count {
    min-height: 24px;
    min-width: 200px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .imgcompress-stats {
    min-height: 24px;
  }
</style>



<!-- SEO & Social Meta Tags -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="{{ config.site_name }}">
<meta property="og:url" content="{{ page.canonical_url }}">
<meta property="og:title" content="{{ page.title | default(config.site_name) }}">
<meta property="og:description" content="{{ page.meta.description | default(config.site_description) }}">
<meta property="og:image" content="{{ config.site_url }}images/imgcompress-og-image.webp">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="ImgCompress: Simple & Private Self-Hosted Docker Image Optimizer">
<meta property="og:locale" content="en_US">
<meta name="keywords"
  content="{% if page.meta.tags %}{{ page.meta.tags | join(', ') }}{% else %}docker image compressor, open source image toolkit, self-hosted background remover, offline image tools, homelab tools, privacy focused image converter, imgcompress{% endif %}">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content="{{ page.canonical_url }}">
<meta name="twitter:title" content="{{ page.title | default(config.site_name) }}">
<meta name="twitter:description" content="{{ page.meta.description | default(config.site_description) }}">
<meta name="twitter:image" content="{{ config.site_url }}images/imgcompress-og-image.webp">
<meta name="twitter:image:alt" content="ImgCompress: Simple & Private Self-Hosted Docker Image Optimizer">

<!-- Explicit Favicons for Search Engines -->
<link rel="icon" type="image/x-icon" href="{{ config.site_url }}images/favicon.ico">
<link rel="icon" type="image/png" href="{{ config.site_url }}images/favicon.png">
<link rel="apple-touch-icon" href="{{ config.site_url }}images/apple-touch-icon.png">

<link rel="me" href="https://github.com/karimz1">
<link rel="me" href="https://karimzouine.com">

<!-- Structured Data -->
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "SoftwareApplication",
        "@id": "{{ config.site_url }}#software",
        "name": "ImgCompress",
        "url": "{{ config.site_url }}",
        "downloadUrl": "https://github.com/karimz1/imgcompress",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": "Docker, Windows, Linux, MacOS",
        "description": "{{ config.site_description | replace('\n', ' ') }}",
        "softwareVersion": "latest",
        "screenshot": "{{ config.site_url }}images/web-ui-workflow/web-ui-upload-configure.webp",
        "image": {
          "@type": "ImageObject",
          "url": "{{ config.site_url }}images/imgcompress-og-image.webp",
          "width": "1024",
          "height": "1024"
        },
        "featureList": [
          "Image compression and optimization",
          "AI-powered background removal",
          "HEIC/HEIF to JPG conversion",
          "PDF to image extraction",
          "Batch processing with multi-core support",
          "CLI automation for CI/CD pipelines",
          "70+ format support including WebP, AVIF, PSD, EPS, TIFF"
        ],
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "author": {
          "@id": "https://karimzouine.com/#person"
        }
      },
      {
        "@type": "Person",
        "@id": "https://karimzouine.com/#person",
        "name": "{{ config.site_author }}",
        "url": "https://karimzouine.com",
        "sameAs": [
          "https://github.com/karimz1",
          "https://github.com/karimz1/imgcompress",
          "https://hub.docker.com/r/karimz1/imgcompress",
          "https://imgcompress.karimzouine.com"
        ]
      },
      {
        "@type": "WebSite",
        "@id": "{{ config.site_url }}#website",
        "url": "{{ config.site_url }}",
        "name": "{{ config.site_name }}",
        "publisher": {
          "@id": "https://karimzouine.com/#person"
        }
      },
      {
        "@type": "TechArticle",
        "@id": "{{ page.canonical_url }}#article",
        "headline": "{{ page.title | default(config.site_name) }}",
        "description": "{{ page.meta.description | default(config.site_description) }}",
        "url": "{{ page.canonical_url }}",
        "author": {
          "@id": "https://karimzouine.com/#person"
        },
        "publisher": {
          "@id": "https://karimzouine.com/#person"
        },
        "mainEntityOfPage": "{{ page.canonical_url }}",
        "about": {
          "@id": "{{ config.site_url }}#software"
        },
        "keywords": "{% if page.meta.tags %}{{ page.meta.tags | join(', ') }}{% else %}docker image compressor, open source image toolkit, self-hosted background remover, offline image tools, homelab tools, privacy focused image converter, imgcompress{% endif %}",
        "proficiencyLevel": "Beginner"
      },
      {
        "@type": "BreadcrumbList",
        "@id": "{{ page.canonical_url }}#breadcrumb",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "{{ config.site_url }}"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "{{ page.title | default('Documentation') }}",
            "item": "{{ page.canonical_url }}"
          }
        ]
      }
    ]
  }
  </script>
{% endblock %}

{% block hero %}
{% if page.meta and page.meta.hero %}
<header class="md-hero md-hero--imgcompress">
  <div class="md-hero__inner">

    <!-- Text Content -->
    <h1 class="imgcompress-title">
      {{ page.meta.hero_title }}
      {% if page.meta.hero_subtitle_gradient %}
      <span class="gradient-text">{{ page.meta.hero_subtitle_gradient }}</span>
      {% endif %}
    </h1>

    <p class="imgcompress-description"
      data-phrases="{% if page.meta.hero_phrases %}{{ page.meta.hero_phrases | join(':::') }}{% endif %}">
      {{ page.meta.hero_description }}
    </p>

    <!-- Actions Container -->
    <div class="imgcompress-actions-container">
      {% if page.meta.hero_button_text %}
      <a href="{{ page.meta.hero_button_link | url }}" class="imgcompress-primary-btn">
        {{ page.meta.hero_button_text }} <i class="fa-solid fa-arrow-right"></i>
      </a>
      {% endif %}
      {% if page.meta.hero_secondary_button_text %}
      <a href="{{ page.meta.hero_secondary_button_link | url }}" class="imgcompress-secondary-btn">
        {{ page.meta.hero_secondary_button_text }}
      </a>
      {% endif %}
    </div>

    <div class="imgcompress-stats" aria-label="Docker pulls">
      <span class="docker-pull-count">Loading...</span>
    </div>

    <!-- Floating UI Screenshot -->
    {% if page.meta.hero_image %}
    <div class="comparison-slider-wrapper">
      <div class="imgcompress-screenshot-container">
        <div class="window-controls">
          <div class="window-dot dot-red"></div>
          <div class="window-dot dot-yellow"></div>
          <div class="window-dot dot-green"></div>
        </div>

        {% if page.meta.hero_image_compare %}
        <div class="comparison-slider">
          <div class="comparison-img original">
            <img src="{{ page.meta.hero_image_compare | url }}" alt="Original App View" loading="eager">
          </div>
          <div class="comparison-img modified">
            <img src="{{ page.meta.hero_image | url }}" alt="Mascot-free App View" loading="eager">
          </div>
          <div class="slider-handle">
            <div class="handle-line"></div>
            <div class="handle-circle">
              <i class="fa-solid fa-arrows-left-right"></i>
            </div>
            <div class="handle-line"></div>
          </div>
        </div>
        {% else %}
        <img src="{{ page.meta.hero_image | url }}" alt="App Screenshot" loading="eager">
        {% endif %}
      </div>

      {% if page.meta.hero_image_compare %}
      <div class="comparison-switch-controls">
        <button class="comparison-switch-btn active" data-pos="0">Standard UI</button>
        <button class="comparison-switch-btn" data-pos="100">Clean UI</button>
      </div>
      <p class="comparison-hint">Toggle <code>DISABLE_LOGO=true</code> to switch to a minimal, mascot-free interface.
      </p>
      {% endif %}
    </div>
    {% endif %}
  </div>
</header>
{% endif %}
{% endblock %}
<!-- EOF -->